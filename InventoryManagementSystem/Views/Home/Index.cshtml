@model InventoryManagementSystem.Domain.ViewModel.DashboardVM
@{
    ViewBag.Title = "Dashboard";
}

<style>
    .container-fluid {
        background-color: white;
    }

    .inner > h3 {
        font-size: 19px;
        color: whitesmoke;
    }

    .small-box-footer > h3 {
        font-size: 1.8em;
        color: ghostwhite;
    }

    .small-box .icon {
        -webkit-transition: all 0.3s linear;
        -o-transition: all 0.3s linear;
        transition: all 0.3s linear;
        position: absolute;
        height: 100%;
        top: 10px;
        right: 10px;
        z-index: 0;
        font-size: 80px;
        color: rgba(0, 0, 0, 0.15);
    }

    .inner > p {
        font-weight: 300;
        font-size: 19px;
        color: darkslategrey;
    }

    #stockTable_length, #stockTable_filter {
        display: none;
    }

    .col-sm-7 {
        width: 100% !important;
    }

    tr {
        font-size: 11px;
        font-family: Arial;
    }

    /*for the nav tabs*/
    #inventoryPanel > .nav-tabs-custom > .nav-tabs > li.active {
        border-top-color: white;
        /*border: 2px solid #1670b5 !important;*/
    }

    #inventoryPanel > .nav-tabs-custom > .nav-tabs > li {
        display: inline-block;
        background: white;
        padding: 0;
        position: relative;
        min-width: 50px;
        text-decoration: none;
        /*-webkit-clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 50%, calc(100% - 15px) 100%, 0 100%, 15px 50%);*/
        clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 50%, calc(100% - 15px) 100%, 0 100%, 15px 50%);
        margin-right: -13px;
    }
        /* first link should not have anything cliped on the left side */
        #inventoryPanel > .nav-tabs-custom > .nav-tabs > li:first-child {
            /*-webkit-clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 50%, calc(100% - 15px) 100%, 0 100%);*/
            clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 50%, calc(100% - 15px) 100%, 0 100%);
        }

        #inventoryPanel > .nav-tabs-custom > .nav-tabs > li > a {
            padding-left: 2.5rem;
            padding-right: 2.5rem;
            margin-right: 5px;
            margin-left: 5px;
            color: black;
        }

            #inventoryPanel > .nav-tabs-custom > .nav-tabs > li > a:hover {
                color: black;
                padding-left: 3.5rem;
                padding-right: 3.5rem;
                margin-right: 5px;
                margin-left: 5px;
            }

    .tab-content {
        border: 3px solid white;
        /*border-radius: 0.6rem;*/
    }

    #approvedRequisitionLink, #approvedRequisitionLink a {
        /*background-color: #f39c12!important;*/
        border-color: #f39c12 !important
    }

    #recentDispatchLink, #recentDispatchLink a {
        /*background-color: #00a65a !important;*/
        border-color: #00a65a !important
    }

    #recentAcknowledgeLink, #recentAcknowledgeLink a {
        /*background-color: #00c0ef !important;*/
        border-color: #428bca !important
    }

    #recentPurchasesLink, #recentPurchasesLink a {
        /*background-color: #dd4b39 !important;*/
        border-color: #b5bbc8 !important
    }

    .moreInfo {
        position: absolute;
        color: blue !important;
        font-size: 1.3rem;
        margin-top: -3rem;
    }

    .info-box:hover {
        color: white;
        box-shadow: rgba(0, 0, 0, 0.15) 2px 1px 1px;
    }
</style>
@if (Session["AssignRole"].ToString().Trim() == "StoreKeeper(HeadOffice)" || Session["AssignRole"].ToString().Trim() == "Admin_User" || Session["AssignRole"].ToString().Trim() == "Administrator")
{
    <div class="nav-tabs-custom">
        <ul class="nav nav-tabs" style="font-size: 15px">
            <li class="active" id="inventoryLink"><a href="#Inventory" data-toggle="tab" aria-expanded="true" data-original-title="" title=""><strong>Inventory</strong></a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane active" id="Inventory">
                <div class="row">
                    <div class="col-md-8">
                        <div class="panel panel-primary" style="overflow: auto; min-height: 56.1rem;">
                            <div class="panel-body" id="inventoryPanel" style="overflow: auto">
                                <div class="nav-tabs-custom">
                                    <ul class="nav nav-tabs">
                                        <li class="active bg-yellow" id="approvedRequisitionLink"><a href="#approvedRequisitionTable" onclick="setColor('#f39c12')" data-toggle="tab" aria-expanded="true" data-original-title="" title=""><strong style="font-size:11px">Recent Approved Requisition</strong></a></li>
                                        <li class="bg-green" id="recentDispatchLink"><a href="#recentDispatchTable" onclick="setColor('#00a65a')" data-toggle="tab" aria-expanded="true" data-original-title="" title=""><strong style="font-size:11px">Recent Dispatch</strong></a></li>
                                        <li class="" style="background-color: #428bca" id="recentAcknowledgeLink"><a href="#recentAcknowledgeTable" onclick="setColor('#428bca')" data-toggle="tab" aria-expanded="true" data-original-title="" title=""><strong style="font-size:11px">Recent Acknowledge</strong></a></li>
                                        <li class="bg-gray-active" id="recentPurchasesLink"><a href="#recentPurchasesTable" onclick="setColor('#b5bbc8')" data-toggle="tab" aria-expanded="true" data-original-title="" title=""><strong style="font-size:11px">Recent Purchases</strong></a></li>
                                    </ul>
                                    <div class="tab-content" id="tabContent">
                                        <div class="tab-pane active" id="approvedRequisitionTable" style="overflow:auto">
                                            <table class="table table-bordered table-responsive table-striped" id="table">
                                                <thead class="bg-yellow">
                                                    <tr>
                                                        <th>
                                                            SN
                                                        </th>
                                                        <th>
                                                            Req. User
                                                        </th>
                                                        <th>
                                                            Req. Branch
                                                        </th>
                                                        <th>
                                                            Req. Date
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{ int k = 1;}
                                                    @foreach (var item in Model.recentApprovedRequisitionList)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @k
                                                            </td>
                                                            <td>
                                                                <a href="~/DispatchRequisition/ViewApproved/@item.Requistion_message_id" title="Dispatch Requisition" target="_blank">  @item.RequestedBy</a>
                                                            </td>
                                                            <td>
                                                                @item.RequestingBranch
                                                            </td>
                                                            <td>
                                                                @(item.Approved_Date?.ToString("yyyy-MM-dd"))
                                                            </td>
                                                        </tr>
                                                        k++;
                                                    }
                                                </tbody>
                                            </table>
                                        </div>

                                        <div class="tab-pane" id="recentDispatchTable" style="overflow:auto;">
                                            <table class="table table-bordered table-responsive table-striped" id="table">
                                                <thead class="bg-green">
                                                    <tr>
                                                        <th>
                                                            SN
                                                        </th>
                                                        <th>
                                                            Disp. Date
                                                        </th>
                                                        <th>
                                                            Disp. By
                                                        </th>
                                                        <th>
                                                            Req. Branch
                                                        </th>
                                                        <th>
                                                            Req. By
                                                        </th>
                                                        <th>
                                                            Req. Date
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{ int a = 1;}
                                                    @foreach (var item in Model.recentDispatchRequisitionList)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @a
                                                            </td>
                                                            <td>
                                                                @(item.Delivered_Date?.ToString("yyyy-MM-dd"))
                                                            </td>
                                                            <td>
                                                                @item.DispatchedBy
                                                            </td>
                                                            <td>
                                                                @item.RequestingBranch
                                                            </td>
                                                            <td>
                                                                @item.RequestedBy
                                                            </td>
                                                            <td>
                                                                @item.Requ_date.ToString("yyyy-MM-dd")
                                                            </td>
                                                        </tr>
                                                        a++;
                                                    }
                                                </tbody>
                                            </table>
                                        </div>

                                        <div class="tab-pane" id="recentAcknowledgeTable" style="overflow:auto;">
                                            <table class="table table-bordered table-responsive table-striped" id="table">
                                                <thead class="bg-primary">
                                                    <tr>
                                                        <th>
                                                            SN
                                                        </th>
                                                        <th>
                                                            Ack. By
                                                        </th>
                                                        <th>
                                                            Ack. Date
                                                        </th>
                                                        <th>
                                                            Branch
                                                        </th>
                                                        <th>
                                                            Disp. By
                                                        </th>
                                                        <th>
                                                            Disp. Date
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{ int j = 1;}
                                                    @foreach (var item in Model.recentAcknowledgeRequisitionList)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @j
                                                            </td>
                                                            <td>
                                                                @item.ReceivedBy
                                                            </td>
                                                            <td>
                                                                @(item.Acknowledged_Date?.ToString("yyyy-MM-dd"))
                                                            </td>
                                                            <td>
                                                                @item.RequestingBranch
                                                            </td>
                                                            <td>
                                                                @item.DispatchedBy
                                                            </td>
                                                            <td>
                                                                @(item.Delivered_Date?.ToString("yyyy-MM-dd"))
                                                            </td>
                                                        </tr>
                                                        j++;
                                                    }
                                                </tbody>
                                            </table>
                                        </div>

                                        <div class="tab-pane" id="recentPurchasesTable" style="overflow:auto;">
                                            <table class="table table-bordered table-responsive table-striped" id="table">
                                                <thead class="bg-gray-active">
                                                    <tr>
                                                        <th>
                                                            SN
                                                        </th>
                                                        <th>
                                                            Purchase By
                                                        </th>
                                                        <th>
                                                            Branch
                                                        </th>
                                                        <th>
                                                            Date
                                                        </th>
                                                        <th>
                                                            Product
                                                        </th>
                                                        <th>
                                                            Qty.
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @{ int l = 1;}
                                                    @foreach (var item in Model.recentPurchasesList)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @l
                                                            </td>
                                                            <td>
                                                                @item.PurchaseBy
                                                            </td>
                                                            <td>
                                                                @item.PurchasingBranch
                                                            </td>
                                                            <td>
                                                                @(item.entered_date?.ToString("yyyy-MM-dd"))
                                                            </td>
                                                            <td>
                                                                @item.ProductName
                                                            </td>
                                                            <td>
                                                                @item.p_qty
                                                            </td>
                                                        </tr>
                                                        l++;
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*<div class="panel panel-primary" style="min-height: 10rem">
                                <div class="panel-body">
                                </div>
                            </div>
                            <br />*@
                    </div>

                    <div class="col-md-4">
                        @*stock level*@
                        <div class="panel panel-danger" style="overflow: auto;">
                            <div class="panel-heading">
                                <b class="pull-left">
                                    <i class="fa fa-list">   </i>
                                    Low Stock/ Re-Order Level Alert!
                                </b>
                                <br />
                            </div>
                            <div class="panel-body">
                                <table class="table table-bordered table-responsive table-striped" id="table">
                                    <thead>
                                        <tr>
                                            <th>
                                                SN
                                            </th>
                                            <th>
                                                Product
                                            </th>
                                            <th>
                                                Unit
                                            </th>
                                            <th>
                                                Qty
                                            </th>
                                            <th>
                                                Re-Order Level
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{ int i = 1;}
                                        @foreach (var item in Model.stockLevelList)
                                        {
                                        <tr>
                                            <td>
                                                @i
                                            </td>
                                            <td>
                                                @item.ProductName
                                            </td>
                                            <td>
                                                @item.Unit
                                            </td>
                                            <td>
                                                @item.stock_in_hand
                                            </td>
                                            <td>
                                                @item.REORDER_LEVEL
                                            </td>
                                        </tr>
                                            i++;
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        @*<div class="panel panel-primary" style="overflow: auto;height: 36rem;border-collapse: collapse;">
                                <div class="panel-heading" style="margin-left: 15px;margin-right: 15px; height:6.5rem;position:sticky;top: 0;">
                                    <b class="pull-left">
                                        <i class="fa fa-list"></i>
                                        <span id="stockBranchName"></span> - Stock In Hand
                                    </b><br />
                                    <div class="row" style="display:block">
                                        <div class="col-md-12">
                                            <div class="form-group" style="display: flex;">
                                                <input type="text" class="form-control" id="itemNameInput" value="" placeholder="Item Name" />
                                                <button type="button" id="itemSearchBtn" class="btn btn-sm btn-success pull-left" onclick="return searchItem()" style="margin-left: 1rem!important; margin-top: -1px;"><i class="fa fa-search"></i>GO</button>
                                            </div>
                                        </div>
                                    </div>
                                    <br />
                                </div>
                                <div class="panel-body" style="padding-top:0;">
                                    <table class="table table-bordered table-responsive table-striped" id="table">
                                        <thead>
                                            <tr>
                                                <th width="20%">
                                                    SN
                                                </th>
                                                <th width="50%" style="border: 1px solid lightgrey">
                                                    Product
                                                </th>
                                                <th width="30%">
                                                    Qty
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="stockInHandBody">
                                            <tr><th colspan="3" style="color:black;">Please Search Item!</th></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>*@
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="box box-primary ">
        <div class="box-header with-border">
            <h3 class="box-title "><span class="visible-md-inline visible-lg-inline"> AT A GLANCE!</span> (@DateTime.Now.ToLongDateString())</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" onclick="RefreshAtAGlance()">
                    <i class="fa fa-refresh"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="collapse">
                    <i class="fa fa-minus"></i>
                </button>
            </div>
        </div>
    </div>
}


<script>
    $(document).ready(function () {
        $('.col-sm-5').remove();

        $('.content-header').remove();
        $('#tabContent').css('border-color', '#f39c12');
    });

    //function to set color.
    function setColor(bgColor) {
        $('#tabContent').css('border-color', bgColor);
        //console.log(Id);
    }
</script>

