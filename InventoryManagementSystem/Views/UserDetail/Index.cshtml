@model  InventoryManagementSystem.Domain.RoleSetupVM.UserRoleVM
@{
    ViewBag.Title = "User Details";
}
@using (Html.BeginForm("Index", "UserDetail", FormMethod.Post, new { id = "detinfo" }))
{
    <div class="box box-primary">
        <div class="box-header with-border">
            <div class="box-title"><i class="fa fa-list"></i> User Details </div>
            <div class="box-tools pull-right">
                <button class="btn btn-box-tool" type="button" data-widget="collapse">
                    <i class="fa fa-minus"></i>
                </button>
            </div>
        </div>
        <div class="box-body formfont">
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="label-control">Branch</label>
                        @Html.DropDownListFor(model => model.BranchId, Model.BranchList, new { @class = "form-control selectSearch" })
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="label-control">Role</label>
                        @Html.DropDownListFor(model => model.role_id, Model.UserRoleList, new { @class = "form-control selectSearch", @id = "pool" })
                    </div>
                </div>

                @*<div class="col-md-3">
                    <div class="form-group">
                        <label class="label-control">Department</label>
                        @Html.DropDownListFor(model => model.Department_id, Model.DepartmentList, new { @class = "form-control selectSearch" })
                    </div>
                </div>*@

                <div class="col-md-1">
                    <div class="form-group">
                        <br />
                        <button type="submit" class="btn btn-success pull-right">Search</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="box-body tablefont">
            <table class="table table-bordered">
                <thead class="thead-dark">
                    <tr>
                        <th>User Id</th>
                        <th>User Name</th>
                        <th>User Full Name</th>
                        <th>Assigned Role</th>
                        <th>Status</th>
                        <th>Branch</th>
                        <th>Department Name</th>
                        <th>Assign Role</th>
                    </tr>
                </thead>
                <tbody>
                    @{ int i = 1;}
                    @foreach (var item in Model.UserRoeVMList)
                    {
                    <tr>
                        <td>
                            @Html.DisplayFor(model => item.AdminId)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.UserName)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.FullName)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.AssignedRole)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.UserStatus)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.BranchName)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.DepartmentName)
                        </td>
                        @if (item.UserStatus == true)
                        {
                            <td>
                                <a href="@Url.Action("AsignRole", "UserDetail", new { assignrole = item.AssignedRole.Trim(), Id = item.row_id, UserName = item.FullName.Trim() })" class="btn btn-xs btn-info" title="Asign Role"><i class="fa fa-anchor"></i></a>
                            </td>
                        }
                    </tr>
                        i++;
                    }
                </tbody>
            </table>
        </div>
    </div>
}

<script>
    $('.table').on('search.dt', function () {
        var record = ''
        record = $('.dataTables_filter input').val();
        localStorage.setItem('record', record);
    });

    $(document).ready(function () {
        $.fn.dataTableExt.sErrMode = 'throw';
        var data = localStorage.getItem('record');
        if (data != '') {
            $('.table').dataTable({
                "oSearch": { "sSearch": data }
            });
        }
    });
</script>